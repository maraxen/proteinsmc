"""Utility functions for protein sequence modeling and sampling."""

from .annealing_schedules import (
  AnnealingScheduleConfig,
  cosine_schedule,
  exponential_schedule,
  linear_schedule,
  static_schedule,
)
from .auto_tuning import (
  AutoTuningConfig,
  BenchmarkResult,
  auto_tune_chunk_size,
  create_test_population,
  estimate_memory_usage,
  get_device_memory_mb,
  suggest_chunk_size_heuristic,
)
from .constants import (
  AA_CHAR_TO_INT_MAP,
  CODON_INT_TO_RES_INT_JAX,
  CODON_TO_RES_CHAR,
  COLABDESIGN_X_INT,
  ECOLI_CODON_FREQ_CHAR,
  ECOLI_CODON_FREQ_JAX,
  ECOLI_MAX_FREQS_JAX,
  INT_TO_AA_CHAR_MAP,
  INT_TO_NUCLEOTIDES_CHAR_MAP,
  MAX_NUC_INT,
  NUCLEOTIDES_CHAR,
  NUCLEOTIDES_INT_MAP,
  NUCLEOTIDES_JAX,
  RES_TO_CODON_CHAR,
  STOP_INT,
  UNKNOWN_AA_INT,
  ECOLI_MAX_FREQS_JAX_list,
)
from .fitness import (
  FitnessEvaluator,
  FitnessFunction,
  calculate_population_fitness,
  chunked_calculate_population_fitness,
  combine_fitness_scores,
  make_sequence_log_prob_fn,
)
from .initiate import generate_template_population
from .metrics import (
  calculate_logZ_increment,
  calculate_position_entropy,
  safe_weighted_mean,
  shannon_entropy,
)
from .mutation import (
  _revert_x_codons_if_mutated,
  chunked_mutation_step,
  dispatch_mutation,
  dispatch_mutation_single,
  diversify_initial_sequences,
  mutate,
  mutate_single,
)
from .pmap_utils import distribute
from .resampling import resample
from .translation import reverse_translate, translate
from .types import (
  EvoSequence,
  FitnessWeights,
  IslandFloats,
  MPNNModel,
  NucleotideSequence,
  PerGenerationFloat,
  PopulationNucleotideSequences,
  PopulationProteinSequences,
  PopulationSequenceBools,
  PopulationSequenceFloats,
  PopulationSequences,
  ProteinSequence,
)
from .vmap_utils import chunked_vmap

__all__ = [
  "AA_CHAR_TO_INT_MAP",
  "CODON_INT_TO_RES_INT_JAX",
  "COLABDESIGN_X_INT",
  "ECOLI_CODON_FREQ_CHAR",
  "ECOLI_CODON_FREQ_JAX",
  "ECOLI_MAX_FREQS_JAX",
  "INT_TO_AA_CHAR_MAP",
  "INT_TO_NUCLEOTIDES_CHAR_MAP",
  "MAX_NUC_INT",
  "NUCLEOTIDES_CHAR",
  "NUCLEOTIDES_INT_MAP",
  "NUCLEOTIDES_JAX",
  "STOP_INT",
  "UNKNOWN_AA_INT",
  "ECOLI_MAX_FREQS_JAX_list",
  "cosine_schedule",
  "exponential_schedule",
  "linear_schedule",
  "static_schedule",
  "AutoTuningConfig",
  "BenchmarkResult",
  "auto_tune_chunk_size",
  "create_test_population",
  "estimate_memory_usage",
  "get_device_memory_mb",
  "suggest_chunk_size_heuristic",
  "FitnessEvaluator",
  "FitnessFunction",
  "calculate_population_fitness",
  "combine_fitness_scores",
  "calculate_position_entropy",
  "shannon_entropy",
  "_revert_x_codons_if_mutated",
  "diversify_initial_sequences",
  "mutate",
  "mutate_single",
  "dispatch_mutation",
  "dispatch_mutation_single",
  "resample",
  "translate",
  "reverse_translate",
  "EvoSequence",
  "FitnessWeights",
  "MPNNModel",
  "NucleotideSequence",
  "PopulationNucleotideSequences",
  "PopulationProteinSequences",
  "PopulationSequenceBools",
  "PopulationSequenceFloats",
  "PopulationSequences",
  "ProteinSequence",
  "RES_TO_CODON_CHAR",
  "CODON_TO_RES_CHAR",
  "calculate_logZ_increment",
  "AnnealingScheduleConfig",
  "make_sequence_log_prob_fn",
  "generate_template_population",
  "IslandFloats",
  "distribute",
  "chunked_vmap",
  "PerGenerationFloat",
  "safe_weighted_mean",
  "chunked_mutation_step",
  "chunked_calculate_population_fitness",
]
